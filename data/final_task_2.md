# Итоговое задание №2

### [Назад в Содержание ⤶](/README.md)

## Задача
Создать три таблицы в БД и написать запрос с соединением этих таблиц. В ответе укажите ссылку на файл.  

### Подзадачи
1. Создать три таблицы так, чтобы: в первой хранились фамилии, во второй имена, в третьей — отчества.
2. Заполнить первую значениями: Иванов, Петров, Сидоров. Вторую: Иван, Петр, Сидор. Третью: Иванович, Петрович, Сидорович.
3. Написать запрос, результат выполнения которого будет возвращать три Ф.И.О *целиком*: Иванов Иван Иванович, 
Петров Петр Петрович, Сидоров Сидор Сидорович, но в обратном алфавитном порядке (по убыванию).

## Решение задачи
### Создание таблиц
Напишем скрипт создания таблицы для фамилии:

```sql
CREATE TABLE firstname (
    id serial PRIMARY KEY,
    firstname VARCHAR(30) NOT NULL)
;
```

По аналогии повторим для имени и отчества.

### Наполнение таблиц
Напишем скрипт наполнения таблицы для фамилии:

```sql
INSERT INTO firstname (firstname) 
 VALUES ('Иванов'),
        ('Петров'),
        ('Сидоров')
;
```

По аналогии повторим для имени и отчества.

### Пишем запрос
Выбираем необходимые колонки и объединяем ФИО с помощью ***CONCAT_WS*** в одну строку, используя пробел в качестве 
разделителя. Далее с помощью ***JOIN*** соединяем три таблицы по ключу `id`.

```sql
SELECT CONCAT_WS(' ', f.firstname, s.surname, l.lastname) AS full_name
FROM firstname AS f
JOIN surname AS s ON f.id = s.id
JOIN lastname AS l ON f.id = l.id
ORDER BY 1 DESC
;
```

<img src="/img/task_2.png" width="20%">

[Итоговое задание №2 (код)](final_task_2.sql)