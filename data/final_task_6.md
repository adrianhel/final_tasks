# Итоговое задание №6

### [Назад в Содержание ⤶](/README.md)

## Задача
Задание состоит из двух частей. Необходимо сгенерировать тестовые данные и провести их анализ с помощью **PySpark**. 
В качестве ответа приложите только код на **Spark**. Формат решения `.ipynb`.  

## Часть 1. Генерация информации
### Суть задачи
Используем библиотеку **Faker** для генерации логов веб-сервера.  

### Выходные данные
Логи содержат следующую информацию:
- _IP-адрес клиента_  
- _Временная метка запроса_  
- _HTTP-метод (GET, POST, etc.)_  
- _URL запроса_  
- _Код ответа (200, 404, etc.)_  
- _Размер ответа в байтах_  

### Формат выходных данных
После генерации 100,000 записей логов сохраняем их в _CSV_-файл `web_server_logs.csv`. 

Перед генерацией не забудьте выполнить в терминале команду: 

```bash
pip install faker
```

### Код для генерации
[Генерация тестовых данных (код)](final_task_6.1.py)

### Пример получившихся данных

<img src="/img/task_6.1.png" width="70%">

## Часть 2. Анализ информации
### Подзадачи
1. Сгруппировать данные по _IP_ и посчитать количество запросов для каждого IP, вывести 10 самых активных IP.  
2. Сгруппировать данные по _HTTP_-методу и посчитать количество запросов для каждого метода.  
3. Профильтровать и посчитать количество запросов с кодом ответа 404.  
4. Сгруппировать данные по дате и просуммировать размер ответов, отсортировать по дате.  

### Формат вывода

<img src="/img/task_6.2.png" width="30%">

## Решение задачи
[Итоговое задание №6 (код)](final_task_6.2.py)